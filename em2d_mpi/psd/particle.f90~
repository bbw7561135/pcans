module particle


  implicit none

  private

  public :: particle__solv


contains


  subroutine particle__solv(up,np,nys,nye,nsp,np2,delt,c)

    integer, intent(in)    :: np, nys, nye, nsp
    integer, intent(in)    :: np2(nys:nye,nsp)
    real(8), intent(in)    :: delt, c
    real(8), intent(inout) :: up(5,np,nys:nye,nsp)
    integer :: j, ii, isp
    real(8) :: gam

    do isp=1,nsp
       do j=nys,nye
          do ii=1,np2(j,isp)
             gam = dsqrt(1.0+(+up(3,ii,j,isp)*up(3,ii,j,isp) &
                              +up(4,ii,j,isp)*up(4,ii,j,isp) &
                              +up(5,ii,j,isp)*up(5,ii,j,isp))/(c*c))
             up(1,ii,j,isp) = up(1,ii,j,isp)+up(3,ii,j,isp)*delt/gam
             up(2,ii,j,isp) = up(2,ii,j,isp)+up(4,ii,j,isp)*delt/gam
          enddo
       enddo
    enddo

  end subroutine particle__solv


end module particle
